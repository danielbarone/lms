version: 0.2

phases:
  pre_build:
    commands:
      - cd client && npm i
      - touch .production.env
      - echo REACT_APP_ADMIN_SERVICE_URL=http://3.138.189.210:8080 > .production.env
      - echo REACT_APP_BORROWER_SERVICE_URL=http://54.172.169.206:8090 >> .production.env
      - echo REACT_APP_SERVICES_URI=http://54.167.167.103 >> .production.env
      - touch deploy.sh
      - echo aws s3 sync build s3://lms-app-microservices-client-app --delete --profile microservices-lms > deploy.sh
      - chmod +x ./deploy.sh
      - cd ..
  build:
    commands:
      - echo Build started on `date`
      - echo Compiling...
      - cd client && npm run deploy
  post_build:
    commands:
      - echo Build completed on `date`